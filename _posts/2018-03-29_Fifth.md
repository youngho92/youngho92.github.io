---
layout: post
title: (Reinforcement Learning Project) Training the artificially intelligent Blackjack player

---
### 0. Introduction to Blackjack

<b> Blackjack Objective </b><br>

The objective of the game is to beat the dealer in one of the following ways:

<ul>
  <li>Get 21 points on the player's first two cards (called a "blackjack" or "natural"), without a dealer blackjack.</li>
  <li>Reach a final score higher than the dealer without exceeding 21.</li>
  <li>Let the dealer draw additional cards until their hand exceeds 21.</li>
</ul>
<br>


<b> Game Procedure </b><br>

<img src="/images/NLP/blackjack.png" width="700">
<br>

1) Betting: Players decide how much to bet
2) Dealing: Each player and the dealer are dealt two cards. One of the dealer's cards is faced down.
3) Action: Each player can decide which action to take out of stand, hit, doubledown, and split.
4) Reward: Each player receives reward based on the outcome.
<br>


<b> Player's Action </b><br>

<ul>
  <li>Hit: Request another card. You can request a hit as many times as you like, but if your total goes over 21, you will Bust and therfore lose the hand. </li>
  <li>Stand: Request that you receive no more cards. Your current hand will be judged against the dealer's.</li>
  <li>Doubledown: If you select this option, you will get exactly one more card, your turn will end, and your bet will be doubled. Note: this option will normally only be available immediately after you receive your first two cards, however, Doubling after Splitting is usually allowed.</li>
  <li>Split: If you have two cards of the same denomination, you can split your cards into two hands and play each hand separately. Your original bet will be duplicated for the new hand. Note: according to Atlantic City Blackjack rules, you may only draw one additional card on each ace when splitting a pair of aces. Also note that this option will normally only be available immediately after you receive your first two cards.</li>
 </ul>
 <br>


### 1. Topic Modeling and Sentiment Analysis

<b>1-0. LDA Topic Models with 8 Topics </b><br>
*Bolded topics are more frequent than the others

<ul>
  <li> topic 1: shall, service, may, examination </li>
  <li> topic 2: men, world, people, great </li>
  <li> <b>topic 3: states, government, united, congress (nation topics)</b> </li>
  <li> topic 4: president, would, mr, general </li>
  <li> topic 5: states, slavery, would, south </li>
  <li> <b>topic 6: president, people, mr, general (title topics)</b> </li>
  <li> topic 7: government, upon, would, country </li>
  <li> topic 8: people, us, world, must, america </li>
</ul>
<br>
<b>1-1. Vocabulary Evolution </b><br>
The following picture shows what vocabularies were frequently used in each period.<br>
<img src="/images/NLP/vocabulary.png" width="700">
<br>
From 1780 to 1990, words such as states, government, and united appeared the most while vocabularies that are more related to ordinary people including people, us, American started to replace them since the 20th century.
<br>
I plotted bayesian probabilities for states, government, and people based on LDA topic modeling. It turned out that the probability of the word "people" started to pick up around 1850s after Abraham Lincoln delivered the Gettysburg speech. Succeeding presidents used "people" more often in their speeches after Abraham Lincoln.

<img src="/images/NLP/word_prob.png" width="400" align="middle">
<br>


<b>1-2. Sentiment Analysis </b><br>
I used the TextBlob library to observe how sentiment index changed from 1900 to 2016 as follow. The higher the index is, the more positive words are used in the presidential speeches.
<br>
<img src="/images/NLP/sentiment.png" width="400" align="middle">
<br>
Then, I classified periods based on the degree of sentiment as follow. Sentiment bottomed during the World War 2, the early 1980's energy cisis, and the 2008 financial crisis. On the contrary, the speech sentiment peaked during the post World War 2 and the dotcom bubble periods. During the bad times, negative words such as "bankruptcy, competitive, threat, cost, inflation" appear a lot in the speeches while positive words including "opportunity, right, future" are widely used for the good times as follow.

<img src="/images/NLP/comparison.png" width="800">
<br>


### 2. Clusters

In order to find clusters among presidents, I used Countervectorizer and Gensim to vectorize word frequencies of each president. After vectorizing word frequencies, I applied 2-dimensional PCA to visualize each president's vector and normalize it to find cosine similarities among presidents.

<b>2-0. K-Means with 8</b>
<br>
<img src="/images/NLP/KMeans.png" width="600">

The above plot is the normalized 2-dimensional PCA result. Richard Nixon turned out to be the only president who has his own cluster. 
<br>

<b>2-1. Clusters by Party</b>
<br>
<img src="/images/NLP/byparty.png" width="700">

The above plot shows the difference between democratic presidents and conservative presidents. There is no significant difference between these two parties showing that the agenda for each party has evolved over time. I then analyzed discovered specific vocabularies that were mostly used by each party. The words "free, duty, Vietnam" appeared more frequently in the democratic presidential speeches and "business, tax, Iraq, security" were dominated by conservative presidents.
<br>


<b>2-2. Clusters by Period</b>
<br>
<img src="/images/NLP/bytime.png" width="700">

This plot shows how presidential speeches evolved over time. I was able to detect significant clusters among presidents before 1850s and after 1950s. Especially, vocabularies in the US presidential speeches started to converge on the right below side after 1950s except for Donald Trump. Donald Trump's speech is more similar to the presidents before 1850's and is most similar to the transcripts of Warren Harding, followed by Dwight Eisenhower and Woodrow Wilson.
<br>



### 3. Conclusion


According to the LDA topic models, nation-related vobabularies such as "government, "nation" appeared less after 1850s. In addition, presidential speeches tend to be depressed during the economic recessions while more positive words are used after the post World War 2 period and before the dotcom bubble collapsed. I then applied 2-dimensional PCA to find clusters among presidents and found that there is no strict distinction between parties, implying that parties' agenda have evolved over time. Furthermore, presidential speeches tend to converge after 1950s regardless of the party register except for Donald Trump, whose speech is more similar to presidents such as Warren Harding, Dwight Eisenhower, and Woodrow Wilson.


